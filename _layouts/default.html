<!DOCTYPE html>
<html class="core">
{% include header.html %}
<body class="home">
	{% include sidebar.html invisible=true narrow_show=true %}

	<div class="top-level-content narrow-show">
		<div class="top">
			<div class="content">
				<h1>UX Framework</h1>

				<p class="pe-label pe-label--large">A design system that empowers teams to build better products, faster</p>

				<div class="search-container">
					<input type="text" name="search" class="pe-textInput--basic" placeholder="Search for components..."autocomplete="off">
					<svg role="img"
			       aria-labelledby="r2"
			       focusable="false"
			       class="pe-icon--search-sm-18">
			    <title id="r2">Search the component library</title>
			    <use xlink:href="#search-sm-18"></use>
			  </svg>
					<div class="dropdown"></div>
				</div>
			</div>
		</div>

		<div class="main-heroes">
			<div class="design-hero">
				<h2>Design UI Kit 1.6.0</h2>

				<p>Updated on Jan. 3, 2018</p>
				<p>Start working in Sketch with ready-made UI components such as colors, buttons, and more! To see how a component works and behaves, please refer to the usage guidelines on this site.</p>

				{% include uikit-download.html %}
			</div>

			<div class="dev-hero">
				<h2>Develop with npm</h2>

				<p>Just grab the code and you're ready to go! Build apps faster using our premade elements.</p>

				<a href="https://www.npmjs.com/~pearson-ux" class="pe-btn__primary--btn_large">Go to npm</a>
			</div>
		</div>

		<section class="uikit">
			<div class="header">
				<h2>Components</h2>
				<div class="button-container"><a href="https://sketch.cloud/s/25Wbe/p/page-1/ui-kit" target="_blank" class="pe-btn__primary--btn_large">View Fullscreen</a></div>
			</div>
			<img src="{{site.baseurl}}/UIKit/assets/UI Kit.png" alt="Components available in the library">
		</section>

		<section class="colors">
			<div class="heading">
				<h2>Colors</h2>
				<a href="{{site.baseurl}}/c/colors">View usage guidelines</a>
			</div>

			{% for page in site.pages %}
				{% unless page.title == 'Colors' %}{% continue %}{% endunless %}
				{% unless page.status == 'active' %}{% continue %}{% endunless %}
				{% if page.version contains 'beta' %}{% continue %}{% endif %}

				{% assign latest_colors = page %}
			{% endfor %}

			{% assign borders = "White,White Gray" | split: "," %}

			<div class="palettes">
				{% for palette in latest_colors.palettes %}
				<div class="palette">
					<h3>{{ palette[0] }}</h3>
						{% for color in palette[1] %}
							<div class="color">
								<div class="swatch{% if borders contains color %} border{% endif %}" style="background-color: #{{latest_colors.colors[color].hex}};"></div>
								<div>{{color}}</div>
								<div>#{{latest_colors.colors[color].hex}}</div>
							</div>
						{% endfor %}
					</div>
					{% endfor %}
			</div>
		</section>

		<section class="contact">
			<h2>Questions or Feedback?</h2>
			<ul class="pe-list pe-list--unordered pe-copy pe-copy--large">
				<li>Contact the UXF Design team at <a href="mailto:uxf-design@pearson.com">uxf-design@pearson.com</a></li>
				<li>Contact the UXF Development team at <a href="mailto:uxf-development@pearson.com">uxf-development@pearson.com</a></li>
				<li>Post on the <a href="{{site.baseurl}}/contact">Discussion Board</a></li>
			</ul>
		</section>

		<section class="newsletter">
			<h2>Sign up for our monthly newsletter</h2>
			<p>To subscribe you must first log in with your Pearson email account.</p>
			<a href="https://groups.google.com/a/pearson.com/forum/#!forum/uxf-newsletter/join" target="_blank" class="pe-btn__primary--btn_large">Subscribe</a>
		</section>
	</div>

	<script type="text/javascript">

		var componentData = [
			{% for page in site.pages %}

			{% if page.section != 'Components' or
			 			page.status != 'active'%}
				{% continue %}
			{% endif %}

			{
				name: '{{page.title}}',
				version: '{{page.version}}',
				status: '{{page.status}}',
				url: '{{page.url}}',
				features: [
					{% for block in page.blocks %}
						{% for feature in block.features %}
						'{{feature}}',
						{% endfor %}
					{% endfor %}
				]
			},
			{% endfor %}
		]
		var named = _.chain(componentData)
								 .sortBy('version')
								 .groupBy('name')
								 .value()

		var toggleDropdown = (function() {
			var dropdown = document.querySelector('.search-container .dropdown')
			return function(state) {
				switch (state) {
					case 'closed':
						dropdown.classList.remove('open')
						break;
					case 'open':
						dropdown.classList.add('open')
						break;
					default:
						dropdown.classList.toggle('open')
				}
			}
		})()

		var buildResult = function(result) {
			var resultNode = document.createDocumentFragment()
			var resultDiv = document.createElement('div')
			resultDiv.classList.add('result')

			var link = document.createElement('a')
			link.href = result.url
			resultDiv.appendChild(link)

			var heading = document.createElement('h5')
			heading.textContent = result.name
			link.appendChild(heading)

			var version = document.createElement('p')
			version.textContent = 'Version ' + result.version
			link.appendChild(version)

			resultNode.appendChild(resultDiv)
			return resultNode
		}

		var selectedResult = "lemons"

		var populateDropdown = (function(){
			var dropdown = document.querySelector('.search-container .dropdown')
			return function(contents) {
				dropdown.innerHTML = ''
				selectedResult = contents.firstElementChild
				dropdown.appendChild(contents)
				if (selectedResult) {
					selectedResult.classList.add('selected')
				}
			}
		})()

		document
			.querySelector('.top input')
			.addEventListener('input', function(e) {
				var newVal = e.target.value

				if (newVal.length == 0) {
					toggleDropdown('closed')
				} else {
					toggleDropdown('open')
				}

				var results = fuzzysort.go(
					newVal,
					componentData,
					{
						limit: 5,
						key: 'name'
					}
				)

				var resultsNode = document.createDocumentFragment()
				results.forEach(result => {
					resultsNode.appendChild(buildResult(result.obj))
				})
				populateDropdown(resultsNode)
			})

		var arrowDownDropdown = function() {
			if (selectedResult.nextElementSibling) {
				selectedResult.classList.remove('selected')
				selectedResult = selectedResult.nextElementSibling
				selectedResult.classList.add('selected')
			}
		}

		var arrowUpDropdown = function() {
			if (selectedResult.previousElementSibling) {
				selectedResult.classList.remove('selected')
				selectedResult = selectedResult.previousElementSibling
				selectedResult.classList.add('selected')
			}
		}

		var selectCurrentDropdown = function() {
			window.location.href = selectedResult.children[0].href
		}

		document
			.querySelector('.top input')
			.addEventListener('keydown', function(e) {
				switch (e.keyCode) {
					case 40:
						e.preventDefault()
						arrowDownDropdown()
						break
					case 38:
						e.preventDefault()
						arrowUpDropdown()
						break
					case 13:
						selectCurrentDropdown()
				}
			})


		var mousedownInsideDropdown = false
		document
			.querySelector('.top .dropdown')
			.addEventListener('mousedown', function(e) {
				mousedownInsideDropdown = true
			})
		document
			.querySelector('.top input')
			.addEventListener('blur', function(e) {
				if (!mousedownInsideDropdown) {
					toggleDropdown('closed')
				}
				mousedownInsideDropdown = false
			})

		document
			.querySelector('.top input')
			.addEventListener('focus', function(e) {
				toggleDropdown('open')
			})

		document
			.querySelector('.top .dropdown')
			.addEventListener('mouseover', function(e) {
				if (!e.target.matches('div.result')) { return }
				if (e.target == selectedResult) { return }

				selectedResult.classList.remove('selected')
				selectedResult = e.target
				selectedResult.classList.add('selected')
			})

		window.addEventListener('pageshow', function(e) {
			if (e.persisted) {
				selectedResult = null
				populateDropdown(null)
			}
		})

		// window.addEventListener('pagehide', function(e) {
		// 	alert(e)
		// })
	</script>

	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-75266302-1', 'auto');
	  ga('send', 'pageview');

	</script>
</body>
</html>
